import{a as z}from"./chunk-O3D5PKJ7.js";import{Ha as h,Ja as u,Ka as T,Ma as v,Oa as C,Pa as x,Qa as b,Ra as l,Rb as D,Sa as r,Sb as k,Ta as P,Tb as H,Ua as w,Ub as A,Va as E,Vb as N,W as y,Xa as F,Ya as c,Z as M,cb as O,db as $,eb as L,fb as s,fc as q,gb as m,gc as R,hb as g,hc as j,jc as Q,lb as B,ob as I,qb as p,rb as f,sb as _,ua as o,va as S}from"./chunk-REU5YPZU.js";var V=(()=>{class t{transform(e,...i){return e>0?`+${e}`:`${e}`}static \u0275fac=function(i){return new(i||t)};static \u0275pipe=M({name:"numberSign",type:t,pure:!0,standalone:!0})}return t})();var K=["scrollableTable"],U=(t,n)=>({positive:t,negative:n});function W(t,n){t&1&&(l(0,"th"),s(1,"Date"),r())}function X(t,n){if(t&1&&(h(0,W,2,0,"th"),l(1,"th"),s(2),p(3,"titlecase"),r()),t&2){let e=n.$implicit,i=n.$index;v(i===0?0:-1),o(2),m(f(3,2,e))}}function Y(t,n){if(t&1&&(s(0),p(1,"date")),t&2){let e=c().$implicit;g(" ",_(1,1,e,"HH:mm")," ")}}function Z(t,n){if(t&1&&(s(0),p(1,"date")),t&2){let e=c().$implicit;g(" ",_(1,1,e,"MMM dd")," ")}}function ee(t,n){if(t&1&&(w(0),l(1,"span",13),s(2),p(3,"numberSign"),r(),E()),t&2){let e=n.ngIf;o(),u("ngClass",I(4,U,e>0,e<0)),o(),m(f(3,2,e))}}function te(t,n){if(t&1&&(l(0,"td"),s(1),p(2,"number"),h(3,ee,4,7,"ng-container",12),r()),t&2){let e=n.$implicit,i=n.$index,a=c().$index,d=c();o(),g("",_(2,2,e.balance,"1.0-0")," "),o(2),u("ngIf",d.getDeltaBalance(a,i))}}function ie(t,n){if(t&1&&(l(0,"tr",9)(1,"td",10),s(2),p(3,"date"),r(),l(4,"td",11),h(5,Y,2,4)(6,Z,2,4),r(),x(7,te,4,5,"td",null,C),r()),t&2){let e=n.$implicit,i=n.$index,a=c();o(2),m(_(3,2,e,"MMM dd HH:mm")),o(3),v(i==0?5:6),o(2),b(a.data==null?null:a.data.get(e))}}function ne(t,n){t&1&&(l(0,"tr")(1,"td",14),s(2),p(3,"translate"),r()()),t&2&&(o(2),m(f(3,1,"No Data")))}var me=(()=>{class t{httpService;scrollableTable;requestFlag=!1;errorResponse;data;dataCopyArr=[];containers=[];constructor(e){this.httpService=e}onDateSelected(e){e&&(setTimeout(()=>this.requestFlag=!0),this.httpService.getLogs(e+"-01").subscribe({next:i=>{this.data=new Map(Object.entries(i)),this.containers.length==0&&this.setContainerNames(),this.dataCopyArr=Array.from(this.data.values())},error:i=>{this.errorResponse=i,this.requestFlag=!1},complete:()=>{this.requestFlag=!1,this.errorResponse=void 0}}))}setContainerNames(){if(this.data)for(let e of this.data?.keys()){this.containers=this.data?.get(e)?.map(i=>i.containerName.toLowerCase()),this.containers.sort();return}}getDeltaBalance(e,i){return!this.dataCopyArr||e+1==this.dataCopyArr.length?0:Math.floor(this.dataCopyArr[e][i].balance)-Math.floor(this.dataCopyArr[e+1][i].balance)}ngAfterViewInit(){if(this.scrollableTable&&this.scrollableTable.nativeElement){let e=this.scrollableTable.nativeElement.getBoundingClientRect().top,a=window.innerHeight-e;this.scrollableTable.nativeElement.style.maxHeight=`${a}px`}}static \u0275fac=function(i){return new(i||t)(S(Q))};static \u0275cmp=y({type:t,selectors:[["app-logs"]],viewQuery:function(i,a){if(i&1&&O(K,5),i&2){let d;$(d=L())&&(a.scrollableTable=d.first)}},standalone:!0,features:[B],decls:18,vars:7,consts:[[3,"dateMonthSelected"],[1,"is-flex","is-justify-content-center","my-1","loading"],[1,"is-size-7"],[3,"error"],[1,"container","is-max-tablet"],[1,"is-flex","is-justify-content-center"],["scrollableTable","",1,"table-container"],[1,"table","is-size-7-touch","is-size-6","is-narrow","is-striped"],[1,"has-background-info"],[1,"has-text-centered"],[1,"is-hidden-touch"],[1,"is-hidden-desktop"],[4,"ngIf"],[1,"delta","is-pulled-right",3,"ngClass"],["colspan","9",1,"has-text-centered"]],template:function(i,a){i&1&&(l(0,"app-date-month",0),F("dateMonthSelected",function(G){return a.onDateSelected(G)}),r(),l(1,"div",1)(2,"p",2),s(3),p(4,"translate"),r(),P(5,"app-error",3),r(),l(6,"div",4)(7,"div",5)(8,"div",6)(9,"table",7)(10,"thead")(11,"tr",8),x(12,X,4,4,"th",null,C),r()(),l(14,"tbody"),x(15,ie,9,5,"tr",9,C,!1,ne,4,3,"tr"),r()()()()()),i&2&&(o(2),T("is-invisible",!a.requestFlag),o(),g("",f(4,5,"Loading")," ..."),o(2),u("error",a.errorResponse),o(7),b(a.containers),o(3),b(a.data==null?null:a.data.keys()))},dependencies:[z,j,R,q,H,A,N,V,D,k],styles:[".delta[_ngcontent-%COMP%]{position:absolute;bottom:-.8em;right:10%;color:#000;border-radius:25%;padding:0 4px;font-size:.9em;font-weight:700;opacity:90%}td[_ngcontent-%COMP%]{position:relative;vertical-align:middle;text-align:center}@media (max-width: 1024px){tr[_ngcontent-%COMP%]{height:35px}}.table.is-striped[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}@media (min-width: 1023px){tr[_ngcontent-%COMP%]{height:45px}}.positive[_ngcontent-%COMP%]{background-color:#7cff77b0}.negative[_ngcontent-%COMP%]{background-color:#ff6e6ea1}.table-container[_ngcontent-%COMP%]{position:relative;max-height:350px;overflow-y:auto}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]{position:sticky;z-index:2}thead[_ngcontent-%COMP%]{top:0}"]})}return t})();export{me as LogsComponent};
